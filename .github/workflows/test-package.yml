# yaml-language-server: $schema=https://json.schemastore.org/github-workflow.json
name: "Test Package"
on:
  workflow_dispatch:
    inputs:
      git_integrate:
        type: "choice"
        description: "{boolean} Whether to integrate with Git to perform scan by every commits."
        required: false
        default: "true"
        options:
          - "false"
          - "true"
      git_limit:
        type: "string"
        description: "{bigint} Limit on how many Git commits will scan."
        required: false
        default: "0"
      git_reverse:
        type: "choice"
        description: "{boolean} Whether to reverse the scan order of the Git commits."
        required: false
        default: "false"
        options:
          - "false"
          - "true"
jobs:
  main:
    name: "Main"
    runs-on: "ubuntu-latest"
    steps:
      - name: "List Docker Image"
        run: |
          docker image ls --all --digests --no-trunc
      - name: "Checkout Repository"
        uses: "actions/checkout@v4.1.1"
        with:
          fetch-depth: 0
      - name: "Scan Repository"
        uses: "hugoalh/scan-virus-ghaction@main"
        with:
          clamav_unofficialassets_use: |-
            .+
          yara_enable: "True"
          git_integrate: "${{github.event.inputs.git_integrate}}"
          git_limit: "${{github.event.inputs.git_limit}}"
          git_reverse: "${{github.event.inputs.git_reverse}}"
          ignores_post: |-
            Param($ElementPostMeta)
            Return ((Get-Random -Minimum 0 -Maximum 2) -eq 1)
          found_summary: "True"
          statistics_summary: "True"
